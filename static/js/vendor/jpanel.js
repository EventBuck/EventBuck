(function(c){c.jPanelMenu=function(g){if("undefined"==typeof g||null==g)g={};var a={options:c.extend({menu:"#menu",trigger:".menu-trigger",excludedPanelContent:"style, script",direction:"left",openPosition:"250px",animated:!0,closeOnContentClick:!0,keyboardShortcuts:[{code:27,open:!1,close:!0},{code:37,open:!1,close:!0},{code:39,open:!0,close:!0},{code:77,open:!0,close:!0}],duration:150,openDuration:g.duration||150,closeDuration:g.duration||150,easing:"ease-in-out",openEasing:g.easing||"ease-in-out",
closeEasing:g.easing||"ease-in-out",before:function(){},beforeOpen:function(){},beforeClose:function(){},after:function(){},afterOpen:function(){},afterClose:function(){},beforeOn:function(){},afterOn:function(){},beforeOff:function(){},afterOff:function(){}},g),settings:{transitionsSupported:"WebkitTransition"in document.body.style||"MozTransition"in document.body.style||"msTransition"in document.body.style||"OTransition"in document.body.style||"Transition"in document.body.style,shiftFixedChildren:!1,
panelPosition:"relative",positionUnits:"px"},menu:"#jPanelMenu-menu",panel:".jPanelMenu-panel",fixedChildren:[],timeouts:{},clearTimeouts:function(){clearTimeout(a.timeouts.open);clearTimeout(a.timeouts.afterOpen);clearTimeout(a.timeouts.afterClose)},setPositionUnits:function(){var b=!1,c=["%","px","em"];for(unitID in c){var e=c[unitID];a.options.openPosition.toString().substr(-e.length)==e&&(b=!0,a.settings.positionUnits=e)}b||(a.options.openPosition=parseInt(a.options.openPosition)+a.settings.positionUnits)},
checkFixedChildren:function(){a.disableTransitions();var b={position:c(a.panel).css("position")};b[a.options.direction]="auto"==c(a.panel).css(a.options.direction)?0:c(a.panel).css(a.options.direction);c(a.panel).find("> *").each(function(){"fixed"==c(this).css("position")&&"auto"==c(this).css(a.options.direction)&&a.fixedChildren.push(this)});if(0<a.fixedChildren.length){var d={position:"relative"};d[a.options.direction]="1px";a.setPanelStyle(d);0==parseInt(c(a.fixedChildren[0]).offset().left)&&
(a.settings.shiftFixedChildren=!0)}a.setPanelStyle(b)},setjPanelMenuStyles:function(){var b="background:#fff",d=c("html").css("background-color"),e=c("body").css("background-color"),f=function(a){var b=[];c.each("background-color background-image background-position background-repeat background-attachment background-size background-clip".split(" "),function(c,d){""<a.css(d)&&b.push(d+":"+a.css(d))});return b.join(";")};"transparent"!=e&&"rgba(0, 0, 0, 0)"!=e?b=f(c("body")):"transparent"!=d&&"rgba(0, 0, 0, 0)"!=
d&&(b=f(c("html")));0==c("#jPanelMenu-style-master").length&&c("body").append('<style id="jPanelMenu-style-master">body{width:100%}.jPanelMenu,body{overflow-x:hidden}#jPanelMenu-menu{display:block;position:fixed;top:0;'+a.options.direction+":0;height:100%;z-index:-1;overflow-x:hidden;overflow-y:scroll;-webkit-overflow-scrolling:touch}.jPanelMenu-panel{position:static;"+a.options.direction+":0;top:0;z-index:2;width:100%;min-height:100%;"+b+";}</style>")},setMenuState:function(a){a=a?"open":"closed";
c("body").attr("data-menu-position",a)},getMenuState:function(){return c("body").attr("data-menu-position")},menuIsOpen:function(){return"open"==a.getMenuState()?!0:!1},setMenuStyle:function(b){c(a.menu).css(b)},setPanelStyle:function(b){c(a.panel).css(b)},showMenu:function(){a.setMenuStyle({display:"block"});a.setMenuStyle({"z-index":"1"})},hideMenu:function(){a.setMenuStyle({"z-index":"-1"});a.setMenuStyle({display:"none"})},enableTransitions:function(b,d){var e=b/1E3,f=a.getCSSEasingFunction(d);
a.disableTransitions();c("body").append('<style id="jPanelMenu-style-transitions">.jPanelMenu-panel{-webkit-transition: all '+e+"s "+f+"; -moz-transition: all "+e+"s "+f+"; -o-transition: all "+e+"s "+f+"; transition: all "+e+"s "+f+";}</style>")},disableTransitions:function(){c("#jPanelMenu-style-transitions").remove()},enableFixedTransitions:function(b,d,e,f){e/=1E3;f=a.getCSSEasingFunction(f);a.disableFixedTransitions(d);c("body").append('<style id="jPanelMenu-style-fixed-'+d+'">'+b+"{-webkit-transition: all "+
e+"s "+f+"; -moz-transition: all "+e+"s "+f+"; -o-transition: all "+e+"s "+f+"; transition: all "+e+"s "+f+";}</style>")},disableFixedTransitions:function(a){c("#jPanelMenu-style-fixed-"+a).remove()},getCSSEasingFunction:function(a){switch(a){case "linear":return a;case "ease":return a;case "ease-in":return a;case "ease-out":return a;case "ease-in-out":return a;default:return"ease-in-out"}},getJSEasingFunction:function(a){switch(a){case "linear":return a;default:return"swing"}},openMenu:function(b){if("undefined"==
typeof b||null==b)b=a.options.animated;a.clearTimeouts();a.options.before();a.options.beforeOpen();a.setMenuState(!0);a.setPanelStyle({position:"relative"});a.showMenu();var d=b?!1:!0,e=b&&a.settings.transitionsSupported?!0:!1;if(e||d)d&&a.disableTransitions(),e&&a.enableTransitions(a.options.openDuration,a.options.openEasing),b={},b[a.options.direction]=a.options.openPosition,a.setPanelStyle(b),a.settings.shiftFixedChildren&&c(a.fixedChildren).each(function(){var b=c(this).prop("tagName").toLowerCase()+
" "+c(this).attr("class"),f=b.replace(" ","."),b=b.replace(" ","-");d&&a.disableFixedTransitions(b);e&&a.enableFixedTransitions(f,b,a.options.openDuration,a.options.openEasing);b={};b[a.options.direction]=a.options.openPosition;c(this).css(b)}),a.timeouts.afterOpen=setTimeout(function(){a.disableTransitions();a.settings.shiftFixedChildren&&c(a.fixedChildren).each(function(){var b=c(this).prop("tagName").toLowerCase()+" "+c(this).attr("class"),b=b.replace(" ","-");a.disableFixedTransitions(b)});a.options.after();
a.options.afterOpen();a.initiateContentClickListeners()},a.options.openDuration);else{var f=a.getJSEasingFunction(a.options.openEasing);b={};b[a.options.direction]=a.options.openPosition;c(a.panel).stop().animate(b,a.options.openDuration,f,function(){a.options.after();a.options.afterOpen();a.initiateContentClickListeners()});a.settings.shiftFixedChildren&&c(a.fixedChildren).each(function(){var b={};b[a.options.direction]=a.options.openPosition;c(this).stop().animate(b,a.options.openDuration,f)})}},
closeMenu:function(b){if("undefined"==typeof b||null==b)b=a.options.animated;a.clearTimeouts();a.options.before();a.options.beforeClose();a.setMenuState(!1);var d=b?!1:!0,e=b&&a.settings.transitionsSupported?!0:!1;if(e||d)d&&a.disableTransitions(),e&&a.enableTransitions(a.options.closeDuration,a.options.closeEasing),b={},b[a.options.direction]=0+a.settings.positionUnits,a.setPanelStyle(b),a.settings.shiftFixedChildren&&c(a.fixedChildren).each(function(){var b=c(this).prop("tagName").toLowerCase()+
" "+c(this).attr("class"),f=b.replace(" ","."),b=b.replace(" ","-");d&&a.disableFixedTransitions(b);e&&a.enableFixedTransitions(f,b,a.options.closeDuration,a.options.closeEasing);b={};b[a.options.direction]=0+a.settings.positionUnits;c(this).css(b)}),a.timeouts.afterClose=setTimeout(function(){a.setPanelStyle({position:a.settings.panelPosition});a.disableTransitions();a.settings.shiftFixedChildren&&c(a.fixedChildren).each(function(){var b=c(this).prop("tagName").toLowerCase()+" "+c(this).attr("class"),
b=b.replace(" ","-");a.disableFixedTransitions(b)});a.hideMenu();a.options.after();a.options.afterClose();a.destroyContentClickListeners()},a.options.closeDuration);else{var f=a.getJSEasingFunction(a.options.closeEasing);b={};b[a.options.direction]=0+a.settings.positionUnits;c(a.panel).stop().animate(b,a.options.closeDuration,f,function(){a.setPanelStyle({position:a.settings.panelPosition});a.hideMenu();a.options.after();a.options.afterClose();a.destroyContentClickListeners()});a.settings.shiftFixedChildren&&
c(a.fixedChildren).each(function(){var b={};b[a.options.direction]=0+a.settings.positionUnits;c(this).stop().animate(b,a.options.closeDuration,f)})}},triggerMenu:function(b){a.menuIsOpen()?a.closeMenu(b):a.openMenu(b)},initiateClickListeners:function(){c(document).on("click",a.options.trigger,function(){a.triggerMenu(a.options.animated);return!1})},destroyClickListeners:function(){c(document).off("click",a.options.trigger,null)},initiateContentClickListeners:function(){if(!a.options.closeOnContentClick)return!1;
c(document).on("click",a.panel,function(b){a.menuIsOpen()&&a.closeMenu(a.options.animated)});c(document).on("touchend",a.panel,function(b){a.menuIsOpen()&&a.closeMenu(a.options.animated)})},destroyContentClickListeners:function(){if(!a.options.closeOnContentClick)return!1;c(document).off("click",a.panel,null);c(document).off("touchend",a.panel,null)},initiateKeyboardListeners:function(){var b=["input","textarea"];c(document).on("keydown",function(d){var e=c(d.target),f=!1;c.each(b,function(){e.is(this.toString())&&
(f=!0)});if(f)return!0;for(mapping in a.options.keyboardShortcuts)if(d.which==a.options.keyboardShortcuts[mapping].code)return d=a.options.keyboardShortcuts[mapping],d.open&&d.close?a.triggerMenu(a.options.animated):!d.open||d.close||a.menuIsOpen()?!d.open&&d.close&&a.menuIsOpen()&&a.closeMenu(a.options.animated):a.openMenu(a.options.animated),!1})},destroyKeyboardListeners:function(){c(document).off("keydown",null)},setupMarkup:function(){c("html").addClass("jPanelMenu");c("body > *").not(a.menu+
", "+a.options.excludedPanelContent).wrapAll('<div class="'+a.panel.replace(".","")+'"/>');c(a.options.menu).clone().attr("id",a.menu.replace("#","")).insertAfter("body > "+a.panel)},resetMarkup:function(){c("html").removeClass("jPanelMenu");c("body > "+a.panel+" > *").unwrap();c(a.menu).remove()},init:function(){a.options.beforeOn();a.initiateClickListeners();"[object Array]"===Object.prototype.toString.call(a.options.keyboardShortcuts)&&a.initiateKeyboardListeners();a.setjPanelMenuStyles();a.setMenuState(!1);
a.setupMarkup();a.setMenuStyle({width:a.options.openPosition});a.checkFixedChildren();a.setPositionUnits();a.closeMenu(!1);a.options.afterOn()},destroy:function(){a.options.beforeOff();a.closeMenu();a.destroyClickListeners();"[object Array]"===Object.prototype.toString.call(a.options.keyboardShortcuts)&&a.destroyKeyboardListeners();a.resetMarkup();var b={};b[a.options.direction]="auto";c(a.fixedChildren).each(function(){c(this).css(b)});a.fixedChildren=[];a.options.afterOff()}};return{on:a.init,off:a.destroy,
trigger:a.triggerMenu,open:a.openMenu,close:a.closeMenu,isOpen:a.menuIsOpen,menu:a.menu,getMenu:function(){return c(a.menu)},panel:a.panel,getPanel:function(){return c(a.panel)}}}})(jQuery);